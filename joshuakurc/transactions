create view "RIOT_SHOPIFY"."SHOPIFY_RIOTSTORES"."TRANSACTIONS_FLATTENED" AS (

select 
    ADMIN_GRAPHQL_API_ID,
    AMOUNT,
    AUTHORIZATION,
    CREATED_AT,
    CURRENCY,
    ERROR_CODE,
    GATEWAY,
    ID,
    KIND,
    MESSAGE,
    ORDER_ID,
    PARENT_ID,
   PAYMENT_DETAILS:avs_result_code::string AS payment_details_avs_result_code,
   PAYMENT_DETAILS:credit_card_bin::string AS payment_details_credit_card_bin,
   PAYMENT_DETAILS:credit_card_company::string AS payment_details_credit_card_company,
   PAYMENT_DETAILS:credit_card_number::string AS payment_details_credit_card_number,
   PAYMENT_DETAILS:cvv_result_code::string AS payment_details_cvv_result_code,
   RECEIPT:CoupledPaymentInfo::string as receipt_CoupledPaymentInfo,
   RECEIPT:PaymentInfo:ExchangeRate::string as receipt_pay_info_ex_rate,
   RECEIPT:PaymentInfo:FeeAmount::string as receipt_pay_info_FeeAmount,
   RECEIPT:PaymentInfo:GrossAmount::string as receipt_pay_info_GrossAmount,
   RECEIPT:PaymentInfo:ParentTransactionID::string as receipt_pay_info_ParentTransactionID,
   RECEIPT:PaymentInfo:PaymentDate::string as receipt_pay_info_PaymentDate,
   RECEIPT:PaymentInfo:PaymentStatus::string as receipt_pay_info_PaymentStatus,
   RECEIPT:PaymentInfo:PaymentType::string as receipt_pay_info_PaymentType,
   RECEIPT:PaymentInfo:PendingReason::string as receipt_pay_info_PendingReason,
   RECEIPT:PaymentInfo:ProtectionEligibility::string as receipt_pay_info_ProtectionEligibility,
   RECEIPT:PaymentInfo:ProtectionEligibilityType::string as receipt_pay_info_ProtectionEligibilityType,
   RECEIPT:PaymentInfo:ReasonCode::string as receipt_pay_info_ReasonCode,
   RECEIPT:PaymentInfo:ReceiptID::string as receipt_pay_info_ReceiptID,
   RECEIPT:PaymentInfo:SellerDetails:PayPalAccountID::string as receipt_pay_info_seller_PayPalAccountID,
   RECEIPT:PaymentInfo:SellerDetails:SecureMerchantAccountID::string as receipt_pay_info_seller_SecureMerchantAccountID,
   RECEIPT:PaymentInfo:TaxAmount::string as receipt_pay_info_TaxAmount,
   RECEIPT:PaymentInfo:TransactionID::string as receipt_pay_info_TransactionID,
   RECEIPT:PaymentInfo:TransactionType::string as receipt_pay_info_TransactionType,
   RECEIPT:SuccessPageRedirectRequested::string as receipt_SuccessPageRedirectRequested,
   RECEIPT:ack::string as receipt_ack,
    RECEIPT:build::string as receipt_build,
    RECEIPT:correlation_id::string as receipt_correlation_id,
    RECEIPT:coupled_payment_info::string as receipt_coupled_payment_info,
    RECEIPT:exchange_rate::string as receipt_exchange_rate,
    RECEIPT:fee_amount::string as receipt_fee_amount,
    RECEIPT:fee_amount_currency_id::string as receipt_fee_amount_currency_id,
    RECEIPT:gross_amount::string as receipt_gross_amount,
    RECEIPT:gross_amount_currency_id::string as receipt_gross_amount_currency_id,
    RECEIPT:parent_transaction_id::string as receipt_parent_transaction_id,
    RECEIPT:pay_pal_account_id::string as receipt_pay_pal_account_id,
    RECEIPT:payment_date::string as receipt_payment_date,
    RECEIPT:payment_status::string as receipt_payment_status,
    RECEIPT:payment_type::string as receipt_payment_type,
    RECEIPT:pending_reason::string as receipt_pending_reason,
    RECEIPT:protection_eligibility::string as receipt_protection_eligibility,
    RECEIPT:protection_eligibility_type::string as receipt_protection_eligibility_type,
    RECEIPT:reason_code::string as receipt_reason_code,
    RECEIPT:receipt_id::string as receipt_receipt_id,
    RECEIPT:secure_merchant_account_id::string as receipt_secure_merchant_account_id,
    RECEIPT:success_page_redirect_requested::string as receipt_success_page_redirect_requested,
    RECEIPT:tax_amount::string as receipt_tax_amount,
    RECEIPT:tax_amount_currency_id::string as receipt_tax_amount_currency_id,
    RECEIPT:timestamp::string as receipt_timestamp,
    RECEIPT:token::string as receipt_token,
    RECEIPT:transaction_id::string as receipt_transaction_id,
    RECEIPT:transaction_type::string as receipt_transaction_type,
    RECEIPT:version::string as receipt_version,
    SOURCE_NAME,
    t.STATUS as Transaction_Status,
    TEST,
    USER_ID,
    _SDC_BATCHED_AT,
    _SDC_EXTRACTED_AT,
    _SDC_RECEIVED_AT,
    _SDC_SEQUENCE,
    _SDC_TABLE_VERSION
    

FROM "RIOT_SHOPIFY"."SHOPIFY_RIOTSTORES"."TRANSACTIONS" T
)
;
